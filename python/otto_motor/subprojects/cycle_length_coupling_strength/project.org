#+PROPERTY: header-args :session otto_cycle_length :kernel python :pandoc no :async yes :tangle tangle/coupling_strength.py :noweb yes

Here we scan the cycle length and coupling strength.

* Boilerplate
#+name: boilerplate
#+begin_src jupyter-python :results none
    import figsaver as fs
    import plot_utils as pu
    from hiro_models.one_qubit_model import StocProcTolerances
    from hiro_models.otto_cycle import OttoEngine
    import hiro_models.model_auxiliary as aux
    import numpy as np
    import qutip as qt
    import utilities as ut
    import stocproc
    import matplotlib.pyplot as plt
    import otto_utilities as ot

    import ray
    ray.shutdown()

    #ray.init(address='auto')
    ray.init()
    from hops.util.logging_setup import logging_setup
    import logging
    logging_setup(logging.INFO)
    plt.rcParams['figure.figsize'] = (12,4)
#+end_src

* Cycles
We take the same baseline as in [[id:c06111fd-d719-433d-a316-c163f6e1d384][cycle_shift.org]].

But we vary the cycle speed while keeping a fixed proportion
coupling-change/cycle time.
#+NAME: make-model
#+begin_src jupyter-python :results none
  def make_model(Θ, δ):
      (p_H, p_L) = ot.timings(.06, .06)
      return OttoEngine(
            δ=[δ, δ],
            ω_c=[1, 1],
            ψ_0=qt.basis([2], [1]),
            description=f"Classic Cycle",
            k_max=4,
            bcf_terms=[5] * 2,
            truncation_scheme="simplex",
            driving_process_tolerances=[StocProcTolerances(1e-3, 1e-3)] * 2,
            thermal_process_tolerances=[StocProcTolerances(1e-3, 1e-3)] * 2,
            T=[0.5, 4],
            therm_methods=["tanhsinh", "tanhsinh"],
            Δ=1,
            num_cycles=3,
            Θ=Θ,
            dt=0.001,
            timings_H=p_H,
            timings_L=p_L,
            streaming_mode=True,
            shift_to_resonance=(False, False),
            L_shift=(0, 0),
        )
#+end_src


#+begin_src jupyter-python
  δs = [round(δ, 3) for δ in np.linspace(.3, .7, 5)]
  Θs = [round(Θ, 3) for Θ in np.linspace(20, 80, 5)][1:]
  δs, Θs
#+end_src

#+RESULTS:
|  0.3 |  0.4 |  0.5 |  0.6 | 0.7 |
| 35.0 | 50.0 | 65.0 | 80.0 |     |

#+begin_src jupyter-python
  import itertools
  models = [make_model(Θ, δ) for Θ, δ, in itertools.product(Θs, δs)]
#+end_src

#+RESULTS:


* Integrate
#+begin_src jupyter-python
  ot.integrate_online_multi(models, 50_000, increment=10_000, analyze_kwargs=dict(every=10_000))
#+end_src


* Analysis
#+begin_src jupyter-python
  ot.plot_energy(models[5])
#+end_src

#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\tau$ | ylabel= | Energy | > |
[[file:./.ob-jupyter/164cf59963539ffe267c06050906eacc5c84a306.svg]]
:END:

#+begin_src jupyter-python
  for i in range(len(Θs)):
    fig, ax = plt.subplots()
    for model in models[len(δs) * i :len(δs) * (i+1)]:
      pu.plot_with_σ(model.t, model.system_energy(), ax=ax)
#+end_src

#+RESULTS:
:RESULTS:
[[file:./.ob-jupyter/e260500c9f6e3ee5bffaa8e55362d765f315dbd9.svg]]
[[file:./.ob-jupyter/b689998cdfdd74781109afb6a523502318876d06.svg]]
[[file:./.ob-jupyter/88fcef6f0d71dbae4e9a3e3cbaa67b1a3db1363c.svg]]
[[file:./.ob-jupyter/73c5fc49ba925c3d94b2261ba9acb883c7d63471.svg]]
:END:


#+begin_src jupyter-python
    for model in models:
        plt.plot(model.t, abs(model.total_energy_from_power().value - model.total_energy().value))
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/c273a43c171394f3692125872ff6c55120ae3433.svg]]


#+begin_src jupyter-python
  #[model.efficiency(steady_idx=2).value * 100 for model in models][10]
  models[10].strobe, models[1].strobe
#+end_src

#+RESULTS:
| array | ((0 65 130 195)) | array | ((0 1000 2001 3001)) |
| array | ((0 35 70 105))  | array | ((0 1000 2001 3001)) |

#+begin_src jupyter-python
  models[10].system_energy().N
#+end_src

#+RESULTS:
: 80000

#+begin_src jupyter-python
  ot.plot_power_eff_convergence(models, 2)
#+end_src

#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 2 | Axes> | (<AxesSubplot: xlabel= $N$ ylabel= $P$ > <AxesSubplot: xlabel= $N$ ylabel= $\eta$ >) |
[[file:./.ob-jupyter/9153bc446bd9633e64c8e85412f9927be1726228.svg]]
:END:


#+begin_src jupyter-python
  f_power = plt.figure()
  a_power = f_power.add_subplot(1, 1, 1, projection="3d")
  f_work = plt.figure()
  a_work = f_work.add_subplot(1, 1, 1, projection="3d")
  f_efficiency = plt.figure()
  a_efficiency = f_efficiency.add_subplot(1, 1, 1, projection="3d")
  f_mean_inter_power = plt.figure()
  a_mean_inter_power = f_mean_inter_power.add_subplot(1, 1, 1, projection="3d")
  f_mean_system_power = plt.figure()
  a_mean_system_power = f_mean_system_power.add_subplot(1, 1, 1, projection="3d")

  for ax in [a_power, a_efficiency, a_work, a_mean_inter_power, a_mean_system_power]:
      ax.set_box_aspect(aspect=None, zoom=0.7)
      ax.set_xlabel(r"$\delta$")
      ax.set_ylabel(r"$\Theta$")
      ax.xaxis.labelpad = 10
      ax.view_init(elev=30.0, azim=-29, roll=0)


  ot.plot_3d_heatmap(
      models,
      lambda model: np.clip(
          np.nan_to_num(model.efficiency(steady_idx=2).value * 100), 0, np.inf
      ),
      lambda model: model.δ[0],
      lambda model: model.Θ,
      ax=a_efficiency,
  )
  a_efficiency.set_zlabel(r"$\eta$")

  ot.plot_3d_heatmap(
      models,
      lambda model: np.clip(-model.power(steady_idx=2).value * 1000, 0, np.inf),
      lambda model: model.δ[0],
      lambda model: model.Θ,
      ax=a_power,
  )
  a_power.set_zlabel(r"$\bar{P}/10^{-3}$")
  a_power.zaxis.labelpad = 8

  ot.plot_3d_heatmap(
      models,
      lambda model: np.clip(
          ot.val_relative_to_steady(model, model.interaction_power().sum_baths(), 2)[
              1
          ].mean.value
          ,* 1000,
          0,
          np.inf,
      ),
      lambda model: model.δ[0],
      lambda model: model.Θ,
      ax=a_mean_inter_power,
  )
  a_mean_inter_power.set_zlabel(r"$-\bar{P}_\mathrm{int}/10^{-3}$")
  a_mean_inter_power.zaxis.labelpad = 8
  a_mean_inter_power.view_init(elev=30.0, azim=110, roll=0)

  ot.plot_3d_heatmap(
      models,
      lambda model: np.clip(
          -ot.val_relative_to_steady(model, model.system_power().sum_baths(), 2)[
              1
          ].mean.value
          ,* 1000,
          0,
          np.inf,
      ),
      lambda model: model.δ[0],
      lambda model: model.Θ,
      ax=a_mean_system_power,
  )
  a_mean_system_power.set_zlabel(r"$\bar{P}_\mathrm{sys}/10^{-3}$")
  a_mean_system_power.zaxis.labelpad = 8

  ot.plot_3d_heatmap(
      models,
      lambda model: np.clip(-model.power(steady_idx=2).value * model.Θ, 0, np.inf),
      lambda model: model.δ[0],
      lambda model: model.Θ,
      ax=a_work,
  )
  a_work.set_zlabel(r"$-W$")
  a_work.zaxis.labelpad = 8


  plt.tight_layout()

  fs.export_fig("coupling_speed_scan_power", x_scaling=1, y_scaling=1, fig=f_power)
  fs.export_fig("coupling_speed_scan_work", x_scaling=1, y_scaling=1, fig=f_work)
  fs.export_fig(
      "coupling_speed_scan_efficiency", x_scaling=1, y_scaling=1, fig=f_efficiency
  )
  fs.export_fig(
      "coupling_speed_scan_interpower", x_scaling=1, y_scaling=1, fig=f_mean_inter_power
  )
  fs.export_fig(
      "coupling_speed_scan_syspower", x_scaling=1, y_scaling=1, fig=f_mean_system_power
  )
#+end_src

#+RESULTS:
:RESULTS:
[[file:./.ob-jupyter/2f0b0c42049806b930471968f418c6e09a12bb14.svg]]
[[file:./.ob-jupyter/37e8a4ed48d03590f17e8fa905d06a079ef9489d.svg]]
[[file:./.ob-jupyter/58030ee1b1a60e263a7ecff46e5e0978c0ebf080.svg]]
[[file:./.ob-jupyter/3e5f7ce49106a6dccaec67c139a3960c3b5977a3.svg]]
[[file:./.ob-jupyter/0f0039092a2d1bba7e2ee7161fd53005eea9c3d3.svg]]
:END:

#+begin_src jupyter-python
  f = plt.figure()
  a_power = f.add_subplot(121, projection="3d")
  a_efficiency = f.add_subplot(122, projection="3d")
  for ax in [a_power, a_efficiency]:
      ax.set_box_aspect(aspect=None, zoom=0.85)
      ax.set_xlabel(r"$\delta$")
      ax.set_ylabel(r"$\Theta$")

  ot.plot_3d_heatmap(
      models,
      lambda model: np.divide(np.abs(model.power(steady_idx=2).σ), np.abs(model.power(steady_idx=2).value)),
      lambda model: model.δ[0],
      lambda model: model.Θ,
      ax=a_power,
  )
  a_power.set_zlabel(r"$\sigma_P/|P|$")


  ot.plot_3d_heatmap(
      models,
      lambda model: np.divide(np.clip(np.nan_to_num(model.efficiency(steady_idx=2).σ * 100), 0, np.inf), np.abs(model.efficiency(steady_idx=2).value * 100)),
      lambda model: model.δ[0],
      lambda model: model.Θ,
      ax=a_efficiency,
  )
  a_efficiency.set_zlabel(r"$\sigma_\eta/|\eta|$")
  fs.export_fig("coupling_speed_scan_power_efficiency_uncertainty")
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/40d7d6c96595d9d2028f7c9d6b5bb9e1646e07b4.svg]]


* Weak Coupling Limit
#+begin_src jupyter-python :tangle tangle/weak_coupling_model.py
  <<boilerplate>>
  <<make-model>>
#+end_src

#+RESULTS:

#+begin_src jupyter-python :results none :tangle tangle/weak_coupling_model.py
  weak_coupling_model = make_model(50, .01)
  weak_coupling_model.num_cycles = 15
  weak_coupling_model.k_max = 2
#+end_src


** Integrate
#+begin_src jupyter-python  :tangle tangle/weak_coupling_model.py
  ot.integrate_online(weak_coupling_model, 100, analyze_kwargs=dict(every=10_000))
#+end_src

#+RESULTS:
:RESULTS:
#+begin_example
  [INFO    hops.core.integration     290962] Choosing the nonlinear integrator.
  [INFO    root                      290962] Starting analysis process.
  [INFO    root                      290962] Started analysis process with pid 293338.
  [INFO    hops.core.hierarchy_data  290962] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/subprojects/cycle_length_coupling_strength/results_ef8e3679c35345f6c603306d9c116e7f72af929efd9037b1f3858e1f3d306a87.fifo
  [INFO    hops.core.integration     290962] Using 16 integrators.
  [INFO    hops.core.integration     290962] Some 100 trajectories have to be integrated.
  [INFO    hops.core.integration     290962] Using 66 hierarchy states.
    0% 0/100 [00:00<?, ?it/s][INFO    hops.core.signal_delay    290962] caught sig 'SIGINT'

    0% 0/100 [00:10<?, ?it/s]
  2023-07-10 14:21:28,916       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:28,917       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:28,919       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:28,920       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  [INFO    hops.core.signal_delay    290962] caught 1 signal(s)
  2023-07-10 14:21:28,921       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  [INFO    hops.core.signal_delay    290962] emit signal 'SIGINT'
  [INFO    hops.core.signal_delay    290962] caught sig 'SIGINT'
  2023-07-10 14:21:28,924       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:28,927       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:28,928       WARNING worker.py:1404 -- A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: 42eb0de981b10f9ded44f707c2238576ac033f1501000000 Worker ID: ab3bee80797ba4d55a20a02edba9fc252c2f48eed15636ec6543f53b Node ID: 6f18af98e8f1029efc0c6aab222a211f324ccc8890393f00385bece8 Worker IP address: 10.121.151.166 Worker port: 37335 Worker PID: 291261
  2023-07-10 14:21:28,961       WARNING worker.py:1404 -- A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: c73273ba2de9e743dd3864a96c16b15a37f8a0bb01000000 Worker ID: 47c18d4d67e434163287de7d8bd0dad4d633903880d6e64886a1b419 Node ID: 6f18af98e8f1029efc0c6aab222a211f324ccc8890393f00385bece8 Worker IP address: 10.121.151.166 Worker port: 46419 Worker PID: 291262
  2023-07-10 14:21:28,962       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:29,022       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:29,045       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:29,058       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:29,091       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:29,129       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:29,160       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:29,206       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2023-07-10 14:21:29,247       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  [INFO    hops.core.signal_delay    290962] caught 1 signal(s)
  [INFO    hops.core.signal_delay    290962] emit signal 'SIGINT'
#+end_example
# [goto error]
#+begin_example
  [0;31m---------------------------------------------------------------------------[0m
  [0;31mKeyboardInterrupt[0m                         Traceback (most recent call last)
  Cell [0;32mIn[86], line 1[0m
  [0;32m----> 1[0m [43mot[49m[38;5;241;43m.[39;49m[43mintegrate_online[49m[43m([49m[43mweak_coupling_model[49m[43m,[49m[43m [49m[38;5;241;43m100[39;49m[43m,[49m[43m [49m[43manalyze_kwargs[49m[38;5;241;43m=[39;49m[38;5;28;43mdict[39;49m[43m([49m[43mevery[49m[38;5;241;43m=[39;49m[38;5;241;43m10_000[39;49m[43m)[49m[43m)[49m

  File [0;32m~/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/subprojects/cycle_length_coupling_strength/otto_utilities.py:363[0m, in [0;36mintegrate_online[0;34m(model, n, stream_folder, **kwargs)[0m
  [1;32m    362[0m [38;5;28;01mdef[39;00m [38;5;21mintegrate_online[39m(model, n, stream_folder[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
  [0;32m--> 363[0m     [43maux[49m[38;5;241;43m.[39;49m[43mintegrate[49m[43m([49m
  [1;32m    364[0m [43m        [49m[43mmodel[49m[43m,[49m
  [1;32m    365[0m [43m        [49m[43mn[49m[43m,[49m
  [1;32m    366[0m [43m        [49m[43mstream_file[49m[38;5;241;43m=[39;49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43m"[39;49m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mstream_folder[49m[43m [49m[38;5;129;43;01mis[39;49;00m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mstream_folder[49m[43m)[49m
  [1;32m    367[0m [43m        [49m[38;5;241;43m+[39;49m[43m [49m[38;5;124;43mf[39;49m[38;5;124;43m"[39;49m[38;5;124;43mresults_[39;49m[38;5;132;43;01m{[39;49;00m[43mmodel[49m[38;5;241;43m.[39;49m[43mhexhash[49m[38;5;132;43;01m}[39;49;00m[38;5;124;43m.fifo[39;49m[38;5;124;43m"[39;49m[43m,[49m
  [1;32m    368[0m [43m        [49m[43manalyze[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
  [1;32m    369[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
  [1;32m    370[0m [43m    [49m[43m)[49m

  File [0;32m~/src/two_qubit_model/hiro_models/model_auxiliary.py:201[0m, in [0;36mintegrate[0;34m(model, n, data_path, clear_pd, single_process, stream_file, analyze, results_path, analyze_kwargs)[0m
  [1;32m    199[0m         supervisor[38;5;241m.[39mintegrate_single_process(clear_pd)
  [1;32m    200[0m     [38;5;28;01melse[39;00m:
  [0;32m--> 201[0m         supervisor[38;5;241m.[39mintegrate(clear_pd)
  [1;32m    203[0m cleanup([38;5;241m0[39m)

  File [0;32m/nix/store/fai1b55231rnk4jyj0kjicdnqcgdf9ph-python3-3.9.15-env/lib/python3.9/site-packages/hops/core/signal_delay.py:87[0m, in [0;36msig_delay.__exit__[0;34m(self, exc_type, exc_val, exc_tb)[0m
  [1;32m     84[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m([38;5;28mself[39m[38;5;241m.[39msigh[38;5;241m.[39msigs_caught) [38;5;241m>[39m [38;5;241m0[39m [38;5;129;01mand[39;00m [38;5;28mself[39m[38;5;241m.[39mhandler [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
  [1;32m     85[0m     [38;5;28mself[39m[38;5;241m.[39mhandler([38;5;28mself[39m[38;5;241m.[39msigh[38;5;241m.[39msigs_caught)
  [0;32m---> 87[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_restore[49m[43m([49m[43m)[49m

  File [0;32m/nix/store/fai1b55231rnk4jyj0kjicdnqcgdf9ph-python3-3.9.15-env/lib/python3.9/site-packages/hops/core/signal_delay.py:68[0m, in [0;36msig_delay._restore[0;34m(self)[0m
  [1;32m     66[0m [38;5;28;01mfor[39;00m i, s [38;5;129;01min[39;00m [38;5;28menumerate[39m([38;5;28mself[39m[38;5;241m.[39msigs):
  [1;32m     67[0m     signal[38;5;241m.[39msignal(s, [38;5;28mself[39m[38;5;241m.[39mold_handlers[i])
  [0;32m---> 68[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msigh[49m[38;5;241;43m.[39;49m[43memit[49m[43m([49m[43m)[49m

  File [0;32m/nix/store/fai1b55231rnk4jyj0kjicdnqcgdf9ph-python3-3.9.15-env/lib/python3.9/site-packages/hops/core/signal_delay.py:42[0m, in [0;36mSigHandler.emit[0;34m(self)[0m
  [1;32m     40[0m [38;5;28;01mfor[39;00m s [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39msigs_caught:
  [1;32m     41[0m     log[38;5;241m.[39minfo([38;5;124m"[39m[38;5;124memit signal [39m[38;5;124m'[39m[38;5;132;01m{}[39;00m[38;5;124m'[39m[38;5;124m"[39m[38;5;241m.[39mformat(SIG_MAP[s]))
  [0;32m---> 42[0m     [43mos[49m[38;5;241;43m.[39;49m[43mkill[49m[43m([49m[43mos[49m[38;5;241;43m.[39;49m[43mgetpid[49m[43m([49m[43m)[49m[43m,[49m[43m [49m[43ms[49m[43m)[49m

  [0;31mKeyboardInterrupt[0m:
#+end_example
:END:

** Analysis
#+begin_src jupyter-python
  ot.plot_energy(weak_coupling_model)
  weak_coupling_model.total_energy_from_power().slice(slice(weak_coupling_model.strobe[1][1], None, 1)).values
#+end_src

#+RESULTS:
:RESULTS:
| array | ((-0.03997036 -0.03997036 -0.03996733 ... -0.21910526 -0.21910526 -0.21910526)) |
[[file:./.ob-jupyter/c1241b127ae3595367627adfdc9a1f6114cbc6af.svg]]
:END:
#+begin_src jupyter-python
  weak_coupling_model.total_power().value[weak_coupling_model.strobe[1][7]:-1].mean()

  #weak_coupling_model.strobe[1]
#+end_src

#+RESULTS:
: 0.0



#+begin_src jupyter-python
weak_coupling_model.efficiency(steady_idx=7)
weak_coupling_model.steady_bath_energy_change(steady_idx=7, bath=1)
weak_coupling_model.steady_total_energy_change(steady_idx=7)
#+end_src

#+RESULTS:
: EnsembleValue([(100, 8.326672684688674e-17, 0.010617712466080408)])


* Things to Look At
- power and efficiency
- magnitude of interaction energies
- magnitude of interaction powers
