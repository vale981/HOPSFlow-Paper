#+PROPERTY: header-args :session otto_baseline :kernel python :pandoc no :async yes :tangle otto_baseline.py

* Boilerplate
#+name: boilerplate
#+begin_src jupyter-python :results none
    import figsaver as fs
    import plot_utils as pu
    from hiro_models.one_qubit_model import StocProcTolerances
    from hiro_models.otto_cycle import OttoEngine
    import hiro_models.model_auxiliary as aux
    import numpy as np
    import qutip as qt
    import utilities as ut
    import stocproc
    import matplotlib.pyplot as plt
    import otto_utilities as ot

    import ray
    ray.shutdown()

    ray.init(address='auto')
    #ray.init()
    from hops.util.logging_setup import logging_setup
    import logging
    logging_setup(logging.INFO)
    plt.rcParams['figure.figsize'] = (12,4)
#+end_src

* Model: Baseline
:PROPERTIES:
:header-args: :tangle baseline.py :session baseline :noweb yes :async yes
:END:

A basic otto cycle that has a finite power output.

#+begin_src jupyter-python
  <<boilerplate>>
#+end_src

#+RESULTS:
: 2022-12-10 18:36:09,974       INFO worker.py:956 -- Connecting to existing Ray cluster at address: 10.0.0.102:6379

#+begin_src jupyter-python
  model = OttoEngine(
      Î´=[0.4, 0.4],
      Ï‰_c=[1, 1],
      Ïˆ_0=qt.basis([2], [1]),
      description=f"A basic near-markovian, weakly coupled Otto Cycle that actually works.",
      k_max=4,
      bcf_terms=[6] * 2,
      truncation_scheme="simplex",
      driving_process_tolerances=[StocProcTolerances(1e-4, 1e-4)] * 2,
      thermal_process_tolerances=[StocProcTolerances(1e-4, 1e-4)] * 2,
      T=[1, 10],
      therm_methods=["tanhsinh", "fft"],
      Î”=1,
      num_cycles=5,
      Î˜=1.5 / 0.05,
      dt=0.001,
      timings_H=(0, 0.1, 0.5, 0.6),
      timings_L=((0.6, 0.7, 0.9, 1), (0.1, 0.2, 0.4, 0.5)),
      streaming_mode=True,
      # solver_args=dict(rtol=1e-3, atol=1e-3)
  )
#+end_src

#+RESULTS:
: [2m[36m(pid=gcs_server)[0m [2022-12-10 18:34:40,075 E 836176 836176] (gcs_server) gcs_server.cc:283: Failed to get the resource load: GrpcUnavailable: RPC Error message: Socket closed; RPC Error details:
: [2m[36m(pid=gcs_server)[0m [2022-12-10 18:34:40,076 E 836176 836176] (gcs_server) gcs_server.cc:283: Failed to get the resource load: GrpcUnavailable: RPC Error message: Socket closed; RPC Error details:
: [2m[36m(pid=gcs_server)[0m [2022-12-10 18:34:40,076 E 836176 836176] (gcs_server) gcs_server.cc:283: Failed to get the resource load: GrpcUnavailable: RPC Error message: Socket closed; RPC Error details:
: [2m[36m(pid=gcs_server)[0m [2022-12-10 18:34:40,076 E 836176 836176] (gcs_server) gcs_server.cc:283: Failed to get the resource load: GrpcUnavailable: RPC Error message: Socket closed; RPC Error details:
: [2m[36m(pid=gcs_server)[0m [2022-12-10 18:34:40,076 E 836176 836176] (gcs_server) gcs_server.cc:283: Failed to get the resource load: GrpcUnavailable: RPC Error message: Socket closed; RPC Error details:
: [2m[36m(pid=gcs_server)[0m [2022-12-10 18:34:40,076 E 836176 836176] (gcs_server) gcs_server.cc:283: Failed to get the resource load: GrpcUnavailable: RPC Error message: Socket closed; RPC Error details:
: [2m[36m(pid=gcs_server)[0m [2022-12-10 18:34:40,076 E 836176 836176] (gcs_server) gcs_server.cc:283: Failed to get the resource load: GrpcUnavailable: RPC Error message: Socket closed; RPC Error details:


#+begin_src jupyter-python :tangle no
  ot.plot_cycle(model)
#+end_src

#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\tau$ | ylabel= | Operator Norm | > |
[[file:./.ob-jupyter/b9c6fe129cc6f48b499ba5507d42fad2b917e830.svg]]
:END:


#+begin_src jupyter-python :tangle no
  ot.integrate_online(model, 5000, analyze_kwargs=dict(every=100))
#+end_src

** Results
:PROPERTIES:
:header-args:  :session baseline_res :noweb yes :async yes
:END:

#+begin_src jupyter-python
    import otto_utilities as ot
    from baseline import model

    ot.plot_energy(model)
#+end_src

#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\tau$ | ylabel= | Energy | > |
[[file:./.ob-jupyter/35dcfbedcee78b470c1b319c79069c0e810714a4.svg]]
:END:



#+begin_src jupyter-python
  model.efficiency(), model.power()
#+end_src

#+RESULTS:
| EnsembleValue | (((4999 0.30111959935298505 0.004893266566388082))) | EnsembleValue | (((4999 -0.002945848125810441 2.901871200949723e-05))) |


#+begin_src jupyter-python
    ot.full_report(model)
#+end_src

#+RESULTS:
:RESULTS:
[[file:./.ob-jupyter/0852c11e266a37e92a5294569e34abb5695b2ecd.svg]]
: [2m[36m(raylet)[0m Spilled 2746 MiB, 1285 objects, write throughput 121 MiB/s. Set RAY_verbose_spill_logs=0 to disable this message.
:END:
:RESULTS:
: \(P=-0.002946\pm 0.000029\)
: \(\eta=30.1\pm 0.5\)
[[file:./.ob-jupyter/8886ba10a0709961381a019dc9c7fa14126142c2.svg]]
[[file:./.ob-jupyter/ff76c13b95ea6b171bfd66927097c017aea9efd9.svg]]
:END:

* Model: Baseline, continously coupled
:PROPERTIES:
:header-args: :tangle baseline_cc.py :session baseline_cc :noweb yes :async yes
:END:

A basic otto cycle that has a finite power output without coupling modulation.

#+begin_src jupyter-python
  <<boilerplate>>
#+end_src

#+RESULTS:

#+begin_src jupyter-python
  model = OttoEngine(
      Î´=[0.4, 0.4],
      Ï‰_c=[1, 1],
      Ïˆ_0=qt.basis([2], [1]),
      description=f"A basic near-markovian, weakly coupled Otto Cycle that actually works.",
      k_max=4,
      bcf_terms=[6] * 2,
      truncation_scheme="simplex",
      driving_process_tolerances=[StocProcTolerances(1e-4, 1e-4)] * 2,
      thermal_process_tolerances=[StocProcTolerances(1e-4, 1e-4)] * 2,
      T=[1, 10],
      therm_methods=["tanhsinh", "fft"],
      Î”=1,
      num_cycles=5,
      Î˜=1.5 / 0.05,
      dt=0.001,
      timings_H=(0, 0.1, 0.5, 0.6),
      timings_L=(None, None),
      streaming_mode=True,
  )

  ot.plot_cycle(model)
#+end_src

#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\tau$ | ylabel= | Operator Norm | > |
[[file:./.ob-jupyter/46af558100f1bf6a8d5d1a125a7e3116ba1d2dff.svg]]
:END:


#+begin_src jupyter-python :tangle no
  ot.integrate_online(model, 5000, analyze_kwargs=dict(every=500))
#+end_src

#+RESULTS:
#+begin_example
  [INFO    hops.core.integration     220084] Choosing the nonlinear integrator.
  [INFO    root                      220084] Starting analysis process.
  [INFO    root                      220084] Started analysis process with pid 224653.
  [INFO    hops.core.hierarchy_data  220084] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_f0cbfe14927cd3391051a14d81391c4135087e9e3a2908e3242a8393e98e0640.fifo
  [INFO    hops.core.integration     220084] Using 32 integrators.
  [INFO    hops.core.integration     220084] Some 4925 trajectories have to be integrated.
  [INFO    hops.core.integration     220084] Using 1820 hierarchy states.
   31% 1529/4925 [39:31<1:27:46,  1.55s/it][2m[36m(raylet)[0m Spilled 2746 MiB, 1285 objects, write throughput 121 MiB/s. Set RAY_verbose_spill_logs=0 to disable this message.
  100% 4925/4925 [1:27:30<00:00,  1.07s/it]
#+end_example

** Results
:PROPERTIES:
:header-args:  :session baseline_cc_res :noweb yes :async yes
:END:

#+begin_src jupyter-python
    import otto_utilities as ot
    from baseline_cc import model

    ot.plot_energy(model)
#+end_src

#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\tau$ | ylabel= | Energy | > |
[[file:./.ob-jupyter/8dcf44f140c595dc41af80bf639a4f09febd3ecd.svg]]
[[file:./.ob-jupyter/6b12c2b534b24a0f30d232e3f27f9224e1fff5d3.svg]]
:END:


#+begin_src jupyter-python
  model.efficiency().value, model.power().value
#+end_src

#+RESULTS:
| 0.04458645456091148 | -0.001717584422747308 |


#+begin_src jupyter-python
    ot.full_report(model)
#+end_src

#+RESULTS:
:RESULTS:
: \(P=-0.001718\pm 0.000022\)
: \(\eta=4.46\pm 0.09\)
[[file:./.ob-jupyter/eefdee2f2a0ee389678d59da69931e4273c3099e.svg]]
[[file:./.ob-jupyter/7a9f9b4f3bfcdae6c575cdf9a48181f7b8bdf3a0.svg]]
:END:

* Model: Baseline Without Resonance
:PROPERTIES:
:header-args: :tangle baseline_noshift.py :session baseline_noshift :noweb yes :async yes
:END:

A basic otto cycle that has a finite power output but without resonance.

#+begin_src jupyter-python
  <<boilerplate>>
#+end_src

#+RESULTS:

#+begin_src jupyter-python
  model = OttoEngine(
        Î´=[0.4, 0.4],
        Ï‰_c=[1, 1],
        Ïˆ_0=qt.basis([2], [1]),
        description=f"A basic near-markovian, weakly coupled Otto Cycle that actually works.",
        k_max=4,
        bcf_terms=[6] * 2,
        truncation_scheme="simplex",
        driving_process_tolerances=[StocProcTolerances(1e-4, 1e-4)] * 2,
        thermal_process_tolerances=[StocProcTolerances(1e-4, 1e-4)] * 2,
        T=[1, 10],
        therm_methods=["tanhsinh", "tanhsinh"],
        Î”=1,
        num_cycles=5,
        Î˜=1.5 / 0.05,
        dt=0.001,
        timings_H=(0, 0.1, 0.5, 0.6),
        timings_L=((0.6, 0.7, 0.9, 1), (0.1, 0.2, 0.4, 0.5)),
        streaming_mode=True,
      shift_to_resonance=(False, False),
        # solver_args=dict(rtol=1e-3, atol=1e-3)
    )
  ot.plot_cycle(model)
#+end_src
#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\tau$ | ylabel= | Operator Norm | > |
[[file:./.ob-jupyter/acddb332ae845425647d38aa9f7101a642cf4b0e.svg]]
:END:


#+begin_src jupyter-python
  ot.plot_sd_overview(model)
#+end_src

#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\omega$ | ylabel= | Spectral Density | > |
[[file:./.ob-jupyter/4839b4ab9e0d0198f864dfb8c5bcbdae241a15ad.svg]]
:END:


#+begin_src jupyter-python :tangle no
  ot.integrate_online(model, 5000)
#+end_src


** Results
:PROPERTIES:
:header-args:  :session baseline_noshift_res :noweb yes :async yes
:END:

#+begin_src jupyter-python
  import otto_utilities as ot
  import plot_utils as pu
  from baseline_noshift import model, model_fft

  ot.plot_energy(model)
#+end_src

#+RESULTS:
:RESULTS:
[[file:./.ob-jupyter/4f57719ec56b5d4bcdc1e6c3e2884c37afb8eb35.svg]]
[[file:./.ob-jupyter/67ffcf01a06dcb88c0db99a3f8ae2bc06cda31b0.svg]]
:END:


#+begin_src jupyter-python
  f, a = plt.subplots()
  for bath in range(2):
      pu.plot_with_Ïƒ(model_fft.t, model_fft.bath_energy_flow().for_bath(bath), ax=a)
      pu.plot_with_Ïƒ(model.t, model.bath_energy_flow().for_bath(bath), ax=a)

#+end_src

#+RESULTS:
[[file:./.ob-jupyter/6f685aff0228e4808b573eb24237f728897c4bfb.svg]]


#+begin_src jupyter-python
  import numpy as np

  t = np.linspace(0, 1, 100)

  f, a = plt.subplots()

  for m in [model, model_fft]:
      total = np.zeros_like(t, dtype=complex)
      N = 10_000
      proc = m.thermal_process(1)
      proc.calc_deriv = True
      for _ in range(N):
          proc.new_process()
          total += proc.dot(t).conjugate() * proc(0)

      pu.plot_complex(t, total.conj() / N, ax=a)

  #pu.plot_complex(t, np.gradient(np.gradient(model.thermal_correlations(1)(t), t), t)/ 4, ax=a)
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/3d5ba68b7cd6f8a9ccd027aeebc434cb64bd1986.svg]]

* Tangent: FFT vs TanhSinh
:PROPERTIES:
:header-args: :tangle baseline_noshift.py :session baseline_noshift :noweb yes :async yes
:END:

A basic otto cycle that has a finite power output but without resonance.

#+begin_src jupyter-python
  <<boilerplate>>
#+end_src

#+RESULTS:

#+begin_src jupyter-python
  model = OttoEngine(
      Î´=[0.4, 0.4],
      Ï‰_c=[2, 2],
      Ïˆ_0=qt.basis([2], [1]),
      description=f"A basic near-markovian, weakly coupled Otto Cycle without the shift.",
      k_max=3,
      bcf_terms=[4] * 2,
      truncation_scheme="simplex",
      driving_process_tolerances=[StocProcTolerances(1e-4, 1e-4)] * 2,
      thermal_process_tolerances=[StocProcTolerances(1e-4, 1e-4)] * 2,
      T=[0, 2],
      therm_methods=["tanhsinh", "tanhsinh"],
      Î”=1,
      num_cycles=1,
      Î˜=1.5 / 0.05,
      dt=0.001,
      timings_H=(0, 0.1, 0.5, 0.6),
      timings_L=((0.6, 0.7, 0.9, 1), (0.1, 0.2, 0.4, 0.5)),
      streaming_mode=True,
      shift_to_resonance=(False, False),
      #Ï‰_s_extra=[.1, .1],
  )

  model_fft = model.copy()
  model_fft.therm_methods = ["fft", "fft"]

  ot.plot_cycle(model)
#+end_src
#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\tau$ | ylabel= | Operator Norm | > |
[[file:./.ob-jupyter/5d0bad2e6ef80abb8d60c2cbff3786dd01ebf25e.svg]]
:END:


#+begin_src jupyter-python
  ot.plot_sd_overview(model)
#+end_src

#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\omega$ | ylabel= | Spectral Density | > |
[[file:./.ob-jupyter/914137aa7a7a69ca970157064773bfe0d273e743.svg]]
:END:


#+begin_src jupyter-python :tangle no
  ot.integrate_online(model_fft, 5000)
  ot.integrate_online(model, 5000)
#+end_src

#+RESULTS:
#+begin_example
  [INFO    hops.core.integration     1570847] Choosing the nonlinear integrator.
  [INFO    root                      1570847] Starting analysis process.
  [INFO    root                      1570847] Started analysis process with pid 1576372.
  [INFO    hops.core.hierarchy_data  1570847] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_d3093039d2e9ab9d02aab76a07b979a7141942b32be1e00a2055e9308033416a.fifo
  [INFO    hops.core.integration     1570847] Using 32 integrators.
  [INFO    hops.core.integration     1570847] Some 3958 trajectories have to be integrated.
  [INFO    hops.core.integration     1570847] Using 165 hierarchy states.
  100% 3958/3958 [16:07<00:00,  4.09it/s]
  [INFO    hops.core.integration     1570847] Choosing the nonlinear integrator.
  [INFO    root                      1570847] Starting analysis process.
  [INFO    root                      1570847] Started analysis process with pid 1581080.
  [INFO    hops.core.hierarchy_data  1570847] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_dc05b28e7c3cc07088dd643d6d07bdeebe680b41c0cb58d7c9e0893d182e483a.fifo
  [INFO    hops.core.integration     1570847] Using 32 integrators.
  [INFO    hops.core.integration     1570847] Some 4000 trajectories have to be integrated.
  [INFO    hops.core.integration     1570847] Using 165 hierarchy states.
100% 4000/4000 [16:30<00:00,  4.04it/s]
#+end_example


** Results
:PROPERTIES:
:header-args:  :session baseline_noshift_res :noweb yes :async yes
:END:

#+begin_src jupyter-python
  import otto_utilities as ot
  import plot_utils as pu
  from baseline_noshift import model, model_fft

  ot.plot_energy(model)
#+end_src

#+RESULTS:
:RESULTS:
[[file:./.ob-jupyter/4f57719ec56b5d4bcdc1e6c3e2884c37afb8eb35.svg]]
[[file:./.ob-jupyter/67ffcf01a06dcb88c0db99a3f8ae2bc06cda31b0.svg]]
:END:


#+begin_src jupyter-python
  f, a = plt.subplots()
  for bath in range(2):
      pu.plot_with_Ïƒ(model_fft.t, model_fft.bath_energy_flow().for_bath(bath), ax=a)
      pu.plot_with_Ïƒ(model.t, model.bath_energy_flow().for_bath(bath), ax=a)

#+end_src

#+RESULTS:
[[file:./.ob-jupyter/6f685aff0228e4808b573eb24237f728897c4bfb.svg]]


#+begin_src jupyter-python
  import numpy as np

  t = np.linspace(0, 1, 100)

  f, a = plt.subplots()

  for m in [model, model_fft]:
      total = np.zeros_like(t, dtype=complex)
      N = 10_000
      proc = m.thermal_process(1)
      proc.calc_deriv = True
      for _ in range(N):
          proc.new_process()
          total += proc.dot(t).conjugate() * proc(0)

      pu.plot_complex(t, total.conj() / N, ax=a)

  #pu.plot_complex(t, np.gradient(np.gradient(model.thermal_correlations(1)(t), t), t)/ 4, ax=a)
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/3d5ba68b7cd6f8a9ccd027aeebc434cb64bd1986.svg]]

* Scans
In this section we run some parameter scans on the otto cycle.

** Switching Speed
:PROPERTIES:
:header-args: :tangle speed_coupling_scan.py :session speed_coupling_scan :noweb yes :async yes
:END:
Inspired by cite:Wiedmann2020Mar, we will begin with a scan of coupling strength vs coupling switching speed.

*** Model
A basic otto cycle that has a finite power output but without resonance.

#+begin_src jupyter-python
  <<boilerplate>>
#+end_src

#+RESULTS:

#+begin_src jupyter-python
  def timings(Ï„_c, Ï„_i):
      Ï„_th = (1 - 2 * Ï„_c) / 2
      Ï„_i_on = (Ï„_th - 2*Ï„_i)
      timings_H = (0, Ï„_c, Ï„_c + Ï„_th, 2*Ï„_c + Ï„_th)
      timings_L_hot = (Ï„_c, Ï„_c + Ï„_i, Ï„_c + Ï„_i + Ï„_i_on, Ï„_c + 2 * Ï„_i + Ï„_i_on)

      timings_L_cold = tuple(time + timings_H[2] for time in timings_L_hot)

      return timings_H, (timings_L_cold, timings_L_hot)
#+end_src

#+RESULTS:


- no shift, to keep things simple

#+begin_src jupyter-python
  (p_H, p_L) = timings(0.1, 0.3)
  prototype = OttoEngine(
      Î´=[0.4, 0.4],
      Ï‰_c=[2, 2],
      Ïˆ_0=qt.basis([2], [1]),
      description=f"A model for scanning coupling strength and interactin switch times.",
      k_max=4,
      bcf_terms=[6] * 2,
      truncation_scheme="simplex",
      driving_process_tolerances=[StocProcTolerances(1e-3, 1e-3)] * 2,
      thermal_process_tolerances=[StocProcTolerances(1e-3, 1e-3)] * 2,
      T=[1, 4],
      therm_methods=["tanhsinh", "tanhsinh"],
      Î”=1,
      num_cycles=5,
      Î˜=1.5 / 0.05,
      dt=0.01/8,
      timings_H=p_H,
      timings_L=p_L,
      streaming_mode=True,
      shift_to_resonance=(False, False),
  )

#+end_src

#+RESULTS:

*** Scan Definition
As hamiltonian switching is not very interesting per-se, as it is
diagonal and directly translates into addional power vs longer
coupling we change the switching speed of the interaction and the coupling strength.


#+begin_src jupyter-python
  Î´s = np.round(np.linspace(.3, .5, 3), 3)
  Ï„_Is = np.array([# .05,
                   .1, .15, .2])
  Î´s, Ï„_Is
#+end_src

#+RESULTS:
| array | ((0.3 0.4 0.5)) | array | ((0.1 0.15 0.2)) |

#+begin_src jupyter-python
  models = []

  import itertools

  for Ï„_I, Î´ in itertools.product(Ï„_Is, Î´s):
      (p_H, p_L) = timings(0.1, Ï„_I)

      model = prototype.copy()
      model.Î´ = [Î´, Î´]
      model.timings_H = p_H
      model.timings_L = p_L
      models.append(model)


  ot.plot_cycles(models[:: len(Î´s)])
#+end_src

#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\tau$ | ylabel= | Operator Norm | > |
[[file:./.ob-jupyter/55ffa13bcc23073c28bc5a33e0a8111932c8ffdb.svg]]
:END:

*** Integration
:PROPERTIES:
:header-args: :tangle speed_coupling_integration.py :session speed_coupling_integration :noweb yes :async yes
:END:

#+begin_src jupyter-python
  from speed_coupling_scan import *

  ot.integrate_online_multi(models, 10_000, increment=1000, analyze_kwargs=dict(every=100))
#+end_src

#+RESULTS:
:RESULTS:
#+begin_example
    [INFO    hops.core.integration     352083] Choosing the nonlinear integrator.
    [INFO    root                      352083] Starting analysis process.
    [INFO    root                      352083] Started analysis process with pid 354078.
    [INFO    hops.core.hierarchy_data  352083] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.fifo
    [INFO    hops.core.integration     352083] Using 15 integrators.
    [INFO    hops.core.integration     352083] Some 0 trajectories have to be integrated.
    [INFO    hops.core.integration     352083] Using 1820 hierarchy states.
    0it [00:00, ?it/s]
    [INFO    hops.core.integration     352083] Choosing the nonlinear integrator.
    [INFO    root                      352083] Starting analysis process.
    [INFO    root                      352083] Started analysis process with pid 354089.
    [INFO    hops.core.hierarchy_data  352083] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.fifo
    [INFO    hops.core.integration     352083] Using 15 integrators.
    [INFO    hops.core.integration     352083] Some 0 trajectories have to be integrated.
    [INFO    hops.core.integration     352083] Using 1820 hierarchy states.
  0it [00:00, ?it/s]
    [INFO    hops.core.integration     352083] Choosing the nonlinear integrator.
    [INFO    root                      352083] Starting analysis process.
    [INFO    root                      352083] Started analysis process with pid 354094.
    [INFO    hops.core.hierarchy_data  352083] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_c2bcedc47683a9e450b1a3aafc381ef41cb40159f3e10249baf530d53e0a5616.fifo
    [INFO    hops.core.integration     352083] Using 15 integrators.
    [INFO    hops.core.integration     352083] Some 0 trajectories have to be integrated.
    [INFO    hops.core.integration     352083] Using 1820 hierarchy states.
  0it [00:00, ?it/s]
    [INFO    hops.core.integration     352083] Choosing the nonlinear integrator.
    [INFO    root                      352083] Starting analysis process.
    [INFO    root                      352083] Started analysis process with pid 354099.
    [INFO    hops.core.hierarchy_data  352083] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_f586285b358dfece5758ee19367305af5c90f9e7fa3495bfc6e1e343146ac224.fifo
    [INFO    hops.core.integration     352083] Using 15 integrators.
    [INFO    hops.core.integration     352083] Some 0 trajectories have to be integrated.
    [INFO    hops.core.integration     352083] Using 1820 hierarchy states.
  0it [00:00, ?it/s]
    [INFO    hops.core.integration     352083] Choosing the nonlinear integrator.
    [INFO    root                      352083] Starting analysis process.
    [INFO    root                      352083] Started analysis process with pid 354105.
    [INFO    hops.core.hierarchy_data  352083] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_b3b72b5d8b5ea5633b8ffb42f0ccdc0756692bf830113311a2529bbddd998ca5.fifo
    [INFO    hops.core.integration     352083] Using 15 integrators.
    [INFO    hops.core.integration     352083] Some 0 trajectories have to be integrated.
    [INFO    hops.core.integration     352083] Using 1820 hierarchy states.
  0it [00:00, ?it/s]
    [INFO    hops.core.integration     352083] Choosing the nonlinear integrator.
    [INFO    root                      352083] Starting analysis process.
    [INFO    root                      352083] Started analysis process with pid 354112.
    [INFO    hops.core.hierarchy_data  352083] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_366624b15e7635d88ee87c805715d9c117c8dd942a0e448546d500d4ee54d3d5.fifo
    [INFO    hops.core.integration     352083] Using 15 integrators.
    [INFO    hops.core.integration     352083] Some 0 trajectories have to be integrated.
    [INFO    hops.core.integration     352083] Using 1820 hierarchy states.
  0it [00:00, ?it/s]
    [INFO    hops.core.integration     352083] Choosing the nonlinear integrator.
    [INFO    root                      352083] Starting analysis process.
    [INFO    root                      352083] Started analysis process with pid 354121.
    [INFO    hops.core.hierarchy_data  352083] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_d9fb3c190979ca8d420ffb8e3aa87d802d6ca8456c03a31ce1628f98159deca6.fifo
    [INFO    hops.core.integration     352083] Using 15 integrators.
    [INFO    hops.core.integration     352083] Some 0 trajectories have to be integrated.
    [INFO    hops.core.integration     352083] Using 1820 hierarchy states.
  0it [00:00, ?it/s]
    [INFO    hops.core.integration     352083] Choosing the nonlinear integrator.
    [INFO    root                      352083] Starting analysis process.
    [INFO    root                      352083] Started analysis process with pid 354126.
    [INFO    hops.core.hierarchy_data  352083] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_23143a028d6739074cf61fa89b51996bf37334e4892df36d9f2929d4b3f20326.fifo
    [INFO    hops.core.integration     352083] Using 15 integrators.
    [INFO    hops.core.integration     352083] Some 10 trajectories have to be integrated.
    [INFO    hops.core.integration     352083] Using 1820 hierarchy states.
  100% 10/10 [00:42<00:00,  4.20s/it]
    [INFO    hops.core.integration     352083] Choosing the nonlinear integrator.
    [INFO    root                      352083] Starting analysis process.
    [INFO    root                      352083] Started analysis process with pid 354556.
    [INFO    hops.core.hierarchy_data  352083] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_070424f37f903b024112bee7192fa44b1edf3556fce0d7578023243a83db0b03.fifo
    [INFO    hops.core.integration     352083] Using 15 integrators.
    [INFO    hops.core.integration     352083] Some 10 trajectories have to be integrated.
    [INFO    hops.core.integration     352083] Using 1820 hierarchy states.
    0% 0/10 [00:00<?, ?it/s][INFO    hops.core.signal_delay    352083] caught sig 'SIGINT'
    [INFO    hops.core.signal_delay    352083] caught sig 'SIGINT'
    0% 0/10 [00:20<?, ?it/s]
    [INFO    hops.core.signal_delay    352083] caught 2 signal(s)
    [INFO    hops.core.signal_delay    352083] emit signal 'SIGINT'
    [INFO    hops.core.signal_delay    352083] caught sig 'SIGINT'
    [INFO    hops.core.signal_delay    352083] emit signal 'SIGINT'
    [INFO    hops.core.signal_delay    352083] caught sig 'SIGINT'
    2022-12-16 18:36:05,698     ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
    2022-12-16 18:36:05,703     ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
    2022-12-16 18:36:05,714     ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
    2022-12-16 18:36:05,736     ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
    2022-12-16 18:36:05,746     ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
    2022-12-16 18:36:05,777     ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
    2022-12-16 18:36:05,778     ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
    2022-12-16 18:36:05,778     ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
    2022-12-16 18:36:05,779     ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
    2022-12-16 18:36:05,780     ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
    [INFO    hops.core.signal_delay    352083] caught 2 signal(s)
    [INFO    hops.core.signal_delay    352083] emit signal 'SIGINT'
#+end_example
# [goto error]
#+begin_example
  [0;31m---------------------------------------------------------------------------[0m
  [0;31mKeyboardInterrupt[0m                         Traceback (most recent call last)
  Cell [0;32mIn[6], line 3[0m
  [1;32m      1[0m [38;5;28;01mfrom[39;00m [38;5;21;01mspeed_coupling_scan[39;00m [38;5;28;01mimport[39;00m [38;5;241m*[39m
  [0;32m----> 3[0m [43mot[49m[38;5;241;43m.[39;49m[43mintegrate_online_multi[49m[43m([49m[43mmodels[49m[43m,[49m[43m [49m[38;5;241;43m1000[39;49m[43m,[49m[43m [49m[43mincrement[49m[38;5;241;43m=[39;49m[38;5;241;43m10[39;49m[43m,[49m[43m [49m[43manalyze_kwargs[49m[38;5;241;43m=[39;49m[38;5;28;43mdict[39;49m[43m([49m[43mevery[49m[38;5;241;43m=[39;49m[38;5;241;43m100[39;49m[43m)[49m[43m)[49m

  File [0;32m~/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/otto_utilities.py:170[0m, in [0;36mintegrate_online_multi[0;34m(models, n, increment, *args, **kwargs)[0m
  [1;32m    168[0m [38;5;28;01mwhile[39;00m target [38;5;241m<[39m n:
  [1;32m    169[0m     [38;5;28;01mfor[39;00m model [38;5;129;01min[39;00m models:
  [0;32m--> 170[0m         [43mintegrate_online[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[38;5;28;43mmin[39;49m[43m([49m[43m[[49m[43mn[49m[43m,[49m[43m [49m[43mtarget[49m[43m][49m[43m)[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
  [1;32m    172[0m     target [38;5;241m+[39m[38;5;241m=[39m increment

  File [0;32m~/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/otto_utilities.py:155[0m, in [0;36mintegrate_online[0;34m(model, n, stream_folder, **kwargs)[0m
  [1;32m    154[0m [38;5;28;01mdef[39;00m [38;5;21mintegrate_online[39m(model, n, stream_folder[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
  [0;32m--> 155[0m     [43maux[49m[38;5;241;43m.[39;49m[43mintegrate[49m[43m([49m
  [1;32m    156[0m [43m        [49m[43mmodel[49m[43m,[49m
  [1;32m    157[0m [43m        [49m[43mn[49m[43m,[49m
  [1;32m    158[0m [43m        [49m[43mstream_file[49m[38;5;241;43m=[39;49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43m"[39;49m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mstream_folder[49m[43m [49m[38;5;129;43;01mis[39;49;00m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mstream_folder[49m[43m)[49m
  [1;32m    159[0m [43m        [49m[38;5;241;43m+[39;49m[43m [49m[38;5;124;43mf[39;49m[38;5;124;43m"[39;49m[38;5;124;43mresults_[39;49m[38;5;132;43;01m{[39;49;00m[43mmodel[49m[38;5;241;43m.[39;49m[43mhexhash[49m[38;5;132;43;01m}[39;49;00m[38;5;124;43m.fifo[39;49m[38;5;124;43m"[39;49m[43m,[49m
  [1;32m    160[0m [43m        [49m[43manalyze[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
  [1;32m    161[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
  [1;32m    162[0m [43m    [49m[43m)[49m

  File [0;32m~/src/two_qubit_model/hiro_models/model_auxiliary.py:201[0m, in [0;36mintegrate[0;34m(model, n, data_path, clear_pd, single_process, stream_file, analyze, results_path, analyze_kwargs)[0m
  [1;32m    199[0m         supervisor[38;5;241m.[39mintegrate_single_process(clear_pd)
  [1;32m    200[0m     [38;5;28;01melse[39;00m:
  [0;32m--> 201[0m         supervisor[38;5;241m.[39mintegrate(clear_pd)
  [1;32m    203[0m cleanup([38;5;241m0[39m)

  File [0;32m~/src/hops/hops/core/signal_delay.py:87[0m, in [0;36msig_delay.__exit__[0;34m(self, exc_type, exc_val, exc_tb)[0m
  [1;32m     84[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m([38;5;28mself[39m[38;5;241m.[39msigh[38;5;241m.[39msigs_caught) [38;5;241m>[39m [38;5;241m0[39m [38;5;129;01mand[39;00m [38;5;28mself[39m[38;5;241m.[39mhandler [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
  [1;32m     85[0m     [38;5;28mself[39m[38;5;241m.[39mhandler([38;5;28mself[39m[38;5;241m.[39msigh[38;5;241m.[39msigs_caught)
  [0;32m---> 87[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_restore[49m[43m([49m[43m)[49m

  File [0;32m~/src/hops/hops/core/signal_delay.py:68[0m, in [0;36msig_delay._restore[0;34m(self)[0m
  [1;32m     66[0m [38;5;28;01mfor[39;00m i, s [38;5;129;01min[39;00m [38;5;28menumerate[39m([38;5;28mself[39m[38;5;241m.[39msigs):
  [1;32m     67[0m     signal[38;5;241m.[39msignal(s, [38;5;28mself[39m[38;5;241m.[39mold_handlers[i])
  [0;32m---> 68[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msigh[49m[38;5;241;43m.[39;49m[43memit[49m[43m([49m[43m)[49m

  File [0;32m~/src/hops/hops/core/signal_delay.py:42[0m, in [0;36mSigHandler.emit[0;34m(self)[0m
  [1;32m     40[0m [38;5;28;01mfor[39;00m s [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39msigs_caught:
  [1;32m     41[0m     log[38;5;241m.[39minfo([38;5;124m"[39m[38;5;124memit signal [39m[38;5;124m'[39m[38;5;132;01m{}[39;00m[38;5;124m'[39m[38;5;124m"[39m[38;5;241m.[39mformat(SIG_MAP[s]))
  [0;32m---> 42[0m     [43mos[49m[38;5;241;43m.[39;49m[43mkill[49m[43m([49m[43mos[49m[38;5;241;43m.[39;49m[43mgetpid[49m[43m([49m[43m)[49m[43m,[49m[43m [49m[43ms[49m[43m)[49m

  [0;31mKeyboardInterrupt[0m:
#+end_example
:END:


*** Analysis
:PROPERTIES:
:header-args: :tangle no :session speed_coupling_analysis :noweb yes :async yes
:END:

#+begin_src jupyter-python
  from speed_coupling_scan import *
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/704431a3f5ccc8a1e1152c01f90c9fd4428dedd8.svg]]

**** Import from taurus
#+begin_src bash :results none
  umount taurus
  sshfs -oIdentityFile=~/.ssh/id_ed25519_taurus  s8896854@taurusexport.hrsk.tu-dresden.de:/beegfs/ws/0/s8896854-paper_otto/project/python/otto_motor taurus
#+end_src

#+begin_src jupyter-python
  taurus_path = "taurus"
  from hiro_models.model_auxiliary import import_results
  import_results(other_data_path="./taurus/.data", other_results_path="./taurus/results", interactive=False, models_to_import=models)
#+end_src

#+RESULTS:
#+begin_example
  [INFO    root                      350005] Skipping 2c92f58615625aa8f53a46159c05375069313e5566ba2e7e5e3d4f23be9b0812.
  [INFO    root                      350005] Skipping 7ab00d286619067e63866cb9df3e159b51ebdbeea557b6ed0181f106e9127be2.
  [INFO    root                      350005] Skipping 9f89257094dd5215bf7cd36b6bcda76657047a6cc14f7e1cc3b4ac451c72dddd.
  [INFO    root                      350005] Skipping 750ccbb5b693f77ef025d7e0bbe10d41151e75b7732ce85b227303f6b6ce369d.
  [INFO    root                      350005] Skipping dd468201c5433723b82946b50f425e79f44ca5ffb5b26a2211b7ade7720035c7.
  [INFO    root                      350005] Skipping 7290a763c090c9bd24fc0c678b9d30a7c568342fcb1af2feb47dcb9ec213dc55.
  [INFO    root                      350005] Skipping 9c08cd39e95fb7db9f55852d940635d3ac2242c8a84951e6ff7b0be4a45be183.
  [INFO    root                      350005] Skipping 510d300d2bc8796a92179affa7add161003a1947b092423ba8968c06b13d9138.
  [INFO    root                      350005] Skipping 8b00ac385c8c38c60c11b7de70b19cc2fe773b6d747205addd41636027531f21.
  [INFO    root                      350005] Skipping 913b21d6d0452c46fbb09dd2108db0bd158066ec2615d4f06db16ee7a1383830.
  [INFO    root                      350005] Skipping 44dff06de2fb486af71ff81ed6fb1c3f2a2cec05e9c79b20c79f8929dc8c2544.
  [INFO    root                      350005] Skipping 348972f31c5626ba07814028d2be2d01047bd8b288aea974d5850cc617815eca.
  [INFO    root                      350005] Skipping 2525cfc57bde76caa763082a2d3b1845d1233ffcf2829eae3807b7aa843fc1fe.
  [INFO    root                      350005] Skipping de1d26626b9cb1caaaafa560fc9317fd09f3b084829ee36f4b00d3b04932b44f.
  [INFO    root                      350005] Skipping e987a624a179f89e3abbd7ac4491c48b222c900b8e9600a146433456790381c4.
  [INFO    root                      350005] Skipping c28edd0b75c02bf9ea9fd14535441f816332c5b6c30f78e65d36ea3d936cf41d.
  [INFO    root                      350005] Skipping b451c850bace96a3c9333d9809cd16158bcafd250f755a7b8ea895b2372c1d22.
  [INFO    root                      350005] Skipping 4debe070f35626a0073bb6a60cf48907d9c11574bf91fd5785eedb75c83988e7.
  [INFO    root                      350005] Not importing 369386763a9e87d131786a59a68e8270f5f9c199ccc166c289120c96afb8ebc5.
  [INFO    root                      350005] Not importing f38b81c68cfcd3264318b416e914ba1e5db02587757e9de323b092c87e175ce9.
  [INFO    root                      350005] Not importing 5192d74969d0922ee2a17c3804628178175b6e0aa12b80fe55689f88d14ddb8c.
  [WARNING root                      350005] Importing taurus/.data/85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938/_2/85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_29ec55e10f631000566052c93979057a_1.h5 to .data/85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938/_2/85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_29ec55e10f631000566052c93979057a_1.h5.
  [WARNING root                      350005] The model description is 'A model for scanning coupling strength and interactin switch times.'.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_3000.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_2500.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_4500.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_3500.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_5000.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_500.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_1500.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_5500.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_2000.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_1000.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_4000.npz.
  [WARNING root                      350005] Importing taurus/results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/flow_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_6000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_5500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_3000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_2000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_4000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_5000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_1000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_2500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_3500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_1500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_4500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_6000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_5500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_1500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_6000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_2000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_4000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_2500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_5000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_3000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_1000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_4500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/interaction_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_3500.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_5500.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_4000.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_3500.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_1500.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_3000.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_6000.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_4500.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_5000.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_2000.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_500.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_1000.npz.
  [WARNING root                      350005] Importing taurus/results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_2500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_6000.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_5500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_1500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_5000.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_4500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_3000.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_3500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_1000.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_2000.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_4000.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938.npz to results/system_power_85a27fef0b9414534ff9661e5c85e5efc8bf683a95ef66765b966922dfe2f938_2500.npz.
  [WARNING root                      350005] Importing taurus/.data/0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de/_3/0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3c7dc4ef811607de9b04bec72de0d9a9_1.h5 to .data/0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de/_3/0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3c7dc4ef811607de9b04bec72de0d9a9_1.h5.
  [WARNING root                      350005] The model description is 'A model for scanning coupling strength and interactin switch times.'.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_2000.npz.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_1000.npz.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_5000.npz.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_500.npz.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_4500.npz.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3500.npz.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_4000.npz.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_1500.npz.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3000.npz.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz.
  [WARNING root                      350005] Importing taurus/results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/flow_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_2500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_2500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_2000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_1500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_4000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_1000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_4500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_5000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_5000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_1500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_1000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_2000.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_2500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_4500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_500.npz.
  [WARNING root                      350005] Importing taurus/results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/interaction_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_4000.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_1500.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_4500.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3500.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3000.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_2000.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_5000.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_4000.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_1000.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_500.npz.
  [WARNING root                      350005] Importing taurus/results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_2500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_4000.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3000.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_1000.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_4500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_1500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_2000.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_2500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_3500.npz.
  [WARNING root                      350005] Importing taurus/results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de.npz to results/system_power_0d3b2f0628d019008395ce59b9a89844a3c7a8e449a07023abe8e9d41bb2f0de_5000.npz.
  [INFO    root                      350005] Not importing c2bcedc47683a9e450b1a3aafc381ef41cb40159f3e10249baf530d53e0a5616.
  [INFO    root                      350005] Not importing f586285b358dfece5758ee19367305af5c90f9e7fa3495bfc6e1e343146ac224.
  [INFO    root                      350005] Not importing b3b72b5d8b5ea5633b8ffb42f0ccdc0756692bf830113311a2529bbddd998ca5.
  [INFO    root                      350005] Not importing 366624b15e7635d88ee87c805715d9c117c8dd942a0e448546d500d4ee54d3d5.
  [INFO    root                      350005] Skipping 490f2adc6984d340d3ac20253f73ea341983d9b3a64a7c5c6244e054fb631ec3.
  [INFO    root                      350005] Skipping 5f1eed9e766eada9c318a67e2c86078cca2a8a5c2c39bb6b4436da0a645b3110.
  [INFO    root                      350005] Skipping 98a0f3426650aed9123b4d7d832821c86622f97ee39c51bfd2e2986a19b65c4c.
  [INFO    root                      350005] Skipping bc0c3d63dd79c5fce61aec56329ecf0b9ded4e136280d70bd01b79d7e2898eaf.
  [INFO    root                      350005] Skipping 22e10f301c20fb50d56b8d94d369ac3da032cc7a94338e5ef2678eed582221c9.
  [INFO    root                      350005] Skipping 0da6da607a0a2c352b1a132b6af894996d3694db8cb5c216a30f7b2603ef72aa.
  [INFO    root                      350005] Skipping 493418760d0d1a98007f81bd62273f293ee475b1279e198626c123475e992ac1.
  [INFO    root                      350005] Skipping 7099e4b1e08ac8c1afe693410844a493f0e214ea7bc5384cc2832137c075e31d.
  [INFO    root                      350005] Skipping f8120d503a880c711dd9fee44f3d5e683b7f1b81ff7e69f9cdfe8f885a89be2a.
#+end_example


**** Plots
#+begin_src jupyter-python
  %matplotlib inline

  f, a = plt.subplots()

  for model in models:
      try:
          # pu.plot_with_Ïƒ(model.t, model.total_energy_from_power().sum_baths(), ax=a, label=fr"$\delta={model.Î´[0]}$, $\tau_I={model.timings_L[0][1] - model.timings_L[0][0]:.3}$")
          # pu.plot_with_Ïƒ(model.t, model.total_energy().sum_baths(), ax=a, label=fr"$\delta={model.Î´[0]}$, $\tau_I={model.timings_L[0][1] - model.timings_L[0][0]:.3}$")
          pu.plot_with_Ïƒ(model.t, model.bath_energy().for_bath(1), ax=a, label=fr"$\delta={model.Î´[0]}$, $\tau_I={model.timings_L[0][1] - model.timings_L[0][0]:.3}$")
          print(model.power().N)
      except:
          pass
  a.legend()
#+end_src

#+RESULTS:
:RESULTS:
: 6000
: 6000
: 6000
: 6000
: 5091
: 4000
: 4000
: 4000
: 4000
: <matplotlib.legend.Legend at 0x7fcfb3ed18e0>
[[file:./.ob-jupyter/bf8ed338455b7a1f406e7384eb55d79338aa73cc.svg]]
:END:



#+begin_src jupyter-python
  %matplotlib inline
  import random
  powers = []
  for model in models:
      try:
          print(model.power().N)
          powers.append(-model.power().value)
      except:
          powers.append(0.)
  #powers = np.array([model.power().value for model in models])
  #powers = np.array([random.random() for model in models])
  powers = np.nan_to_num(np.array(powers))
  normalized_powers = powers - powers.min()
  normalized_powers /= normalized_powers.max()
  Blues = plt.get_cmap("plasma")
  colors = [Blues(power) for power in normalized_powers]
  ax1 = plt.gcf().add_subplot(111, projection='3d')

  _xx, _yy = np.meshgrid(Î´s, Ï„_Is)
  x, y = _xx.ravel(), _yy.ravel()
  dx = (Î´s[1] - Î´s[0])
  dy = (Ï„_Is[1] - Ï„_Is[0])
  x -= dx /2
  y -= dy /2
  ax1.bar3d(x, y, np.zeros_like(powers), dx, dy, powers, color=colors)
  ax1.set_xticks(Î´s)
  ax1.set_yticks(Ï„_Is)

  ax1.set_xlabel(r"$\delta$")
  ax1.set_ylabel(r"$\tau_I$")
  ax1.set_zlabel(r"$P$")
#+end_src

#+RESULTS:
:RESULTS:
: 6000
: 6000
: 6000
: 6000
: 5091
: 4000
: 4000
: 4000
: 4000
: Text(0.5, 0, '$P$')
[[file:./.ob-jupyter/7f77383278a6fba4f390f9b4e50141c663db06e2.svg]]
:END:

** Coupling and System Switching overlap
:PROPERTIES:
:header-args: :tangle timing_scan.py :session timing_scan :noweb yes :async yes
:END:
Let's see if it helps switching system and interaction at the same time.

#+begin_src jupyter-python
  <<boilerplate>>
#+end_src

#+RESULTS:

#+begin_src jupyter-python
  def timings(Ï„_c, Ï„_i, percent_overlap=0):
      Ï„_cI = Ï„_c * (1-percent_overlap)

      Ï„_thI = (1 - 2 * Ï„_cI) / 2
      Ï„_th = (1 - 2 * Ï„_c) / 2
      Ï„_i_on = (Ï„_thI - 2*Ï„_i)
      timings_H = (0, Ï„_c, Ï„_c + Ï„_th, 2*Ï„_c + Ï„_th)

      timings_L_hot = (Ï„_cI, Ï„_cI + Ï„_i, Ï„_cI + Ï„_i + Ï„_i_on, Ï„_cI + 2 * Ï„_i + Ï„_i_on)

      timings_L_cold = tuple(time + timings_H[2] for time in timings_L_hot)

      return timings_H, (timings_L_cold, timings_L_hot)
#+end_src

#+RESULTS:


- no shift, to keep things simple

#+begin_src jupyter-python
  Ï„_mod, Ï„_I = 0.1, 0.1
  (p_H, p_L) = timings(Ï„_mod, Ï„_I, .5)
  prototype = OttoEngine(
      Î´=[0.4, 0.4],
      Ï‰_c=[2, 2],
      Ïˆ_0=qt.basis([2], [1]),
      description=f"A model for scanning coupling strength and interactin switch times.",
      k_max=4,
      bcf_terms=[6] * 2,
      truncation_scheme="simplex",
      driving_process_tolerances=[StocProcTolerances(1e-5, 1e-5)] * 2,
      thermal_process_tolerances=[StocProcTolerances(1e-5, 1e-5)] * 2,
      T=[1, 4],
      therm_methods=["tanhsinh", "tanhsinh"],
      Î”=1,
      num_cycles=4,
      Î˜=1.5 / 0.05,
      dt=0.001,
      timings_H=p_H,
      timings_L=p_L,
      streaming_mode=True,
      shift_to_resonance=(False, False),
      L_shift=(0.0, 0.0),
  )
  ot.plot_cycle(prototype)
#+end_src

#+RESULTS:
:RESULTS:
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\tau$ | ylabel= | Operator Norm | > |
[[file:./.ob-jupyter/62e8c8e17864f59b422c319b70a24297cec13f64.svg]]
:END:


Ok we control the overlap and the timing while staying in the region
where the baths are not coupled at the same time.

#+begin_src jupyter-python
  overlaps = np.round(np.linspace(0, 1, 3), 3)
  shifts = np.round(np.linspace(0, Ï„_mod, 3), 3)
#+end_src

#+RESULTS:

#+begin_src jupyter-python
  models = []

  import itertools

  for overlap, shift in itertools.product(overlaps, shifts):
      print(overlap, shift)
      (p_H, p_L) = timings(Ï„_mod, Ï„_I, overlap)

      model = prototype.copy()
      model.timings_H = p_H
      model.timings_L = p_L
      model.L_shift = (shift, shift)
      models.append(model)


  ot.plot_cycles(models)
#+end_src

#+RESULTS:
:RESULTS:
: 0.0 0.0
: 0.0 0.05
: 0.0 0.1
: 0.5 0.0
: 0.5 0.05
: 0.5 0.1
: 1.0 0.0
: 1.0 0.05
: 1.0 0.1
| <Figure | size | 1200x400 | with | 1 | Axes> | <AxesSubplot: | xlabel= | $\tau$ | ylabel= | Operator Norm | > |
[[file:./.ob-jupyter/45d57fc054b1b52f2f73f7312056f2d893b4b509.svg]]
:END:

*** Integration
:PROPERTIES:
:header-args: :tangle timing_scan_integration.py :session timing_scan_integration :noweb yes :async yes
:END:

#+begin_src jupyter-python
  from timing_scan import *

  ot.integrate_online_multi(models, 10_000, increment=2000, analyze_kwargs=dict(every=100))
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/98dd37ab9f7fb351532d5011d5ce23e77891e6bf.svg]]
:RESULTS:
#+begin_example
  0.0 0.0
  0.0 0.05
  0.0 0.1
  0.5 0.0
  0.5 0.05
  0.5 0.1
  1.0 0.0
  1.0 0.05
  1.0 0.1
  [INFO    hops.core.integration     2528809] Choosing the nonlinear integrator.
  [INFO    root                      2528809] Starting analysis process.
  [INFO    root                      2528809] Started analysis process with pid 2529077.
  [INFO    hops.core.hierarchy_data  2528809] Creating the streaming fifo at: /home/hiro/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/results_90fadc67c2414cd2d90f293e30b3f3845a179a0a2bfa979d301a693399ebdf9a.fifo
  [INFO    hops.core.integration     2528809] Using 32 integrators.
  [INFO    hops.core.integration     2528809] Some 5000 trajectories have to be integrated.
  [INFO    hops.core.integration     2528809] Using 1820 hierarchy states.
  0% 0/5000 [00:00<?, ?it/s][INFO    hops.core.signal_delay    2528809] caught sig 'SIGINT'
  0% 0/5000 [00:10<?, ?it/s]
  2022-12-14 13:52:18,108       WARNING worker.py:1404 -- A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: b309d3a73e78f5b2b50c42306e5a32041125cfc10b000000 Worker ID: 64bc45a18eb412c6d6f84112a7db980903cb3e3ea9906f3b09d443d8 Node ID: 0bdeca53c997eb53b259895d3c4dd7ac669151098dcb22ae9627e60f Worker IP address: 10.0.0.102 Worker port: 10114 Worker PID: 2529153
  2022-12-14 13:52:18,145       WARNING worker.py:1404 -- A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: ced707e7670a2fb8943c3793888187459d05ccb60b000000 Worker ID: 57a3439898472c6a46f62690c7d4f00ffb4dbb18d84c2f89fd364443 Node ID: 0bdeca53c997eb53b259895d3c4dd7ac669151098dcb22ae9627e60f Worker IP address: 10.0.0.102 Worker port: 10118 Worker PID: 2529346
  2022-12-14 13:52:18,201       WARNING worker.py:1404 -- A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: 5777b585ec213b4bcef6ebb69daee0075d82861f0b000000 Worker ID: 87965d34ae50809a6e04d8b4d9d407545ce1c0123c5eb1637e24e3af Node ID: 0bdeca53c997eb53b259895d3c4dd7ac669151098dcb22ae9627e60f Worker IP address: 10.0.0.102 Worker port: 10113 Worker PID: 2529093
  2022-12-14 13:52:18,211       WARNING worker.py:1404 -- A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: e298adec5e827c2cf6e41744572c36652487697b0b000000 Worker ID: 13fcc47e3f17d59f538e9d3555552407bb8835717b745b08cfa927e4 Node ID: 0bdeca53c997eb53b259895d3c4dd7ac669151098dcb22ae9627e60f Worker IP address: 10.0.0.102 Worker port: 10111 Worker PID: 2529094
  2022-12-14 13:52:18,230       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,232       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,233       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,234       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,235       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,236       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,236       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,237       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,238       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,238       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,239       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,239       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,240       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  [INFO    hops.core.signal_delay    2528809] caught 1 signal(s)
  2022-12-14 13:52:18,241       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,241       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  [INFO    hops.core.signal_delay    2528809] emit signal 'SIGINT'
  2022-12-14 13:52:18,242       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  [INFO    hops.core.signal_delay    2528809] caught sig 'SIGINT'
  2022-12-14 13:52:18,243       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,244       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,245       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,246       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,246       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,248       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,249       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,249       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,250       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,251       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,251       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,264       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,267       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,267       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  [INFO    hops.core.signal_delay    2528809] caught 1 signal(s)
  [INFO    hops.core.signal_delay    2528809] emit signal 'SIGINT'
#+end_example
# [goto error]
#+begin_example
  [0;31m---------------------------------------------------------------------------[0m
  [0;31mKeyboardInterrupt[0m                         Traceback (most recent call last)
  Cell [0;32mIn[1], line 3[0m
  [1;32m      1[0m [38;5;28;01mfrom[39;00m [38;5;21;01mtiming_scan[39;00m [38;5;28;01mimport[39;00m [38;5;241m*[39m
  [0;32m----> 3[0m [43mot[49m[38;5;241;43m.[39;49m[43mintegrate_online_multi[49m[43m([49m[43mmodels[49m[43m,[49m[43m [49m[38;5;241;43m5000[39;49m[43m,[49m[43m [49m[43manalyze_kwargs[49m[38;5;241;43m=[39;49m[38;5;28;43mdict[39;49m[43m([49m[43mevery[49m[38;5;241;43m=[39;49m[38;5;241;43m100[39;49m[43m)[49m[43m)[49m

  File [0;32m~/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/otto_utilities.py:167[0m, in [0;36mintegrate_online_multi[0;34m(models, *args, **kwargs)[0m
  [1;32m    165[0m [38;5;28;01mdef[39;00m [38;5;21mintegrate_online_multi[39m(models, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
  [1;32m    166[0m     [38;5;28;01mfor[39;00m model [38;5;129;01min[39;00m models:
  [0;32m--> 167[0m         [43mintegrate_online[49m[43m([49m[43mmodel[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

  File [0;32m~/Documents/Projects/UNI/master/eflow_paper/python/otto_motor/otto_utilities.py:155[0m, in [0;36mintegrate_online[0;34m(model, n, stream_folder, **kwargs)[0m
  [1;32m    154[0m [38;5;28;01mdef[39;00m [38;5;21mintegrate_online[39m(model, n, stream_folder[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
  [0;32m--> 155[0m     [43maux[49m[38;5;241;43m.[39;49m[43mintegrate[49m[43m([49m
  [1;32m    156[0m [43m        [49m[43mmodel[49m[43m,[49m
  [1;32m    157[0m [43m        [49m[43mn[49m[43m,[49m
  [1;32m    158[0m [43m        [49m[43mstream_file[49m[38;5;241;43m=[39;49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43m"[39;49m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mstream_folder[49m[43m [49m[38;5;129;43;01mis[39;49;00m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mstream_folder[49m[43m)[49m
  [1;32m    159[0m [43m        [49m[38;5;241;43m+[39;49m[43m [49m[38;5;124;43mf[39;49m[38;5;124;43m"[39;49m[38;5;124;43mresults_[39;49m[38;5;132;43;01m{[39;49;00m[43mmodel[49m[38;5;241;43m.[39;49m[43mhexhash[49m[38;5;132;43;01m}[39;49;00m[38;5;124;43m.fifo[39;49m[38;5;124;43m"[39;49m[43m,[49m
  [1;32m    160[0m [43m        [49m[43manalyze[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
  [1;32m    161[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
  [1;32m    162[0m [43m    [49m[43m)[49m

  File [0;32m~/src/two_qubit_model/hiro_models/model_auxiliary.py:201[0m, in [0;36mintegrate[0;34m(model, n, data_path, clear_pd, single_process, stream_file, analyze, results_path, analyze_kwargs)[0m
  [1;32m    199[0m         supervisor[38;5;241m.[39mintegrate_single_process(clear_pd)
  [1;32m    200[0m     [38;5;28;01melse[39;00m:
  [0;32m--> 201[0m         supervisor[38;5;241m.[39mintegrate(clear_pd)
  [1;32m    203[0m cleanup([38;5;241m0[39m)

  File [0;32m~/src/hops/hops/core/signal_delay.py:87[0m, in [0;36msig_delay.__exit__[0;34m(self, exc_type, exc_val, exc_tb)[0m
  [1;32m     84[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m([38;5;28mself[39m[38;5;241m.[39msigh[38;5;241m.[39msigs_caught) [38;5;241m>[39m [38;5;241m0[39m [38;5;129;01mand[39;00m [38;5;28mself[39m[38;5;241m.[39mhandler [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
  [1;32m     85[0m     [38;5;28mself[39m[38;5;241m.[39mhandler([38;5;28mself[39m[38;5;241m.[39msigh[38;5;241m.[39msigs_caught)
  [0;32m---> 87[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_restore[49m[43m([49m[43m)[49m

  File [0;32m~/src/hops/hops/core/signal_delay.py:68[0m, in [0;36msig_delay._restore[0;34m(self)[0m
  [1;32m     66[0m [38;5;28;01mfor[39;00m i, s [38;5;129;01min[39;00m [38;5;28menumerate[39m([38;5;28mself[39m[38;5;241m.[39msigs):
  [1;32m     67[0m     signal[38;5;241m.[39msignal(s, [38;5;28mself[39m[38;5;241m.[39mold_handlers[i])
  [0;32m---> 68[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msigh[49m[38;5;241;43m.[39;49m[43memit[49m[43m([49m[43m)[49m

  File [0;32m~/src/hops/hops/core/signal_delay.py:42[0m, in [0;36mSigHandler.emit[0;34m(self)[0m
  [1;32m     40[0m [38;5;28;01mfor[39;00m s [38;5;129;01min[39;00m [38;5;28mself[39m[38;5;241m.[39msigs_caught:
  [1;32m     41[0m     log[38;5;241m.[39minfo([38;5;124m"[39m[38;5;124memit signal [39m[38;5;124m'[39m[38;5;132;01m{}[39;00m[38;5;124m'[39m[38;5;124m"[39m[38;5;241m.[39mformat(SIG_MAP[s]))
  [0;32m---> 42[0m     [43mos[49m[38;5;241;43m.[39;49m[43mkill[49m[43m([49m[43mos[49m[38;5;241;43m.[39;49m[43mgetpid[49m[43m([49m[43m)[49m[43m,[49m[43m [49m[43ms[49m[43m)[49m

  [0;31mKeyboardInterrupt[0m:
  2022-12-14 13:52:18,888       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
  2022-12-14 13:52:18,908       ERROR worker.py:94 -- Unhandled error (suppress with 'RAY_IGNORE_UNHANDLED_ERRORS=1'): The worker died unexpectedly while executing this task. Check python-core-worker-*.log files for more information.
#+end_example
[[file:./.ob-jupyter/7c3f9e561e30c73f8ca635e18f752432d87c65ea.svg]]
:END:




*** Analysis
:PROPERTIES:
:header-args: :tangle no :session timing_scan_analysis :noweb yes :async yes
:END:

#+begin_src jupyter-python
  from timing_scan import *
#+end_src

#+RESULTS:
:RESULTS:
: 0.0 0.0
: 0.0 0.05
: 0.0 0.1
: 0.5 0.0
: 0.5 0.05
: 0.5 0.1
: 1.0 0.0
: 1.0 0.05
: 1.0 0.1
[[file:./.ob-jupyter/5aea9248c7b6eb7fe0739f84eb07fa52f241213a.svg]]
[[file:./.ob-jupyter/e9e21d56a5cefcefe6b75a9ce38c36c8251f5823.svg]]
:END:

#+begin_src jupyter-python
  %matplotlib inline
  powers = []
  efficiencies = []
  for model in models:
      #pu.plot_with_Ïƒ(model.t, model.total_power(), ax=a)
      #print(model.power().value, model.efficiency().value, model.power().N)
      try:
          powers.append(-float(model.power(Ïƒ_factor=3).value))
          efficiencies.append(model.efficiency(Ïƒ_factor=3).value)
      except:
          powers.append(0.)
          efficiencies.append(0.)

  f, a =ot.plot_3d_heatmap(np.array(powers), np.array(overlaps), np.array(shifts))
  a.set_xlabel("overlaps")
  a.set_ylabel("shifts")
  a.set_zlabel("Power")

  f, a =ot.plot_3d_heatmap(np.array(efficiencies), np.array(overlaps), np.array(shifts))
  a.set_xlabel("overlaps")
  a.set_ylabel("shifts")
  a.set_zlabel("Efficiency")
#+end_src

#+RESULTS:
:RESULTS:
: Text(0.5, 0, 'Efficiency')
[[file:./.ob-jupyter/4c12796df0291fc07e89d4b7125bc3b88ead8d42.svg]]
[[file:./.ob-jupyter/6efd43c6c360cc807824077099dfa46d8f19dd78.svg]]
:END:


#+begin_src jupyter-python
  f, a = plt.subplots()

  for model in models[:]:
      pu.plot_with_Ïƒ(model.t, model.total_energy_from_power().sum_baths(), ax=a, label=fr"$\delta={model.Î´[0]}$, $\tau_I={model.timings_L[0][1] - model.timings_L[0][0]:.3}$")
      pu.plot_with_Ïƒ(model.t, model.total_energy().sum_baths(), ax=a, label=fr"$\delta={model.Î´[0]}$, $\tau_I={model.timings_L[0][1] - model.timings_L[0][0]:.3}$")
      # pu.plot_with_Ïƒ(model.t, model.system_energy().sum_baths(), ax=a, label=fr"$\delta={model.Î´[0]}$, $\tau_I={model.timings_L[0][1] - model.timings_L[0][0]:.3}$")

      print(model.total_energy().consistency(model.total_energy_from_power()), model.steady_index(), model.power()[-1])
#+end_src

#+RESULTS:
:RESULTS:
: 29.992501874531367 2 EnsembleValue([(4000, -0.0005131979774745943, 2.437443269788402e-05)])
# [goto error]
#+begin_example
  [0;31m---------------------------------------------------------------------------[0m
  [0;31mRuntimeError[0m                              Traceback (most recent call last)
  Cell [0;32mIn[4], line 8[0m
  [1;32m      5[0m pu[38;5;241m.[39mplot_with_Ïƒ(model[38;5;241m.[39mt, model[38;5;241m.[39mtotal_energy()[38;5;241m.[39msum_baths(), ax[38;5;241m=[39ma, label[38;5;241m=[39m[38;5;124mfr[39m[38;5;124m"[39m[38;5;124m$[39m[38;5;124m\[39m[38;5;124mdelta=[39m[38;5;132;01m{[39;00mmodel[38;5;241m.[39mÎ´[[38;5;241m0[39m][38;5;132;01m}[39;00m[38;5;124m$, $[39m[38;5;124m\[39m[38;5;124mtau_I=[39m[38;5;132;01m{[39;00mmodel[38;5;241m.[39mtimings_L[[38;5;241m0[39m][[38;5;241m1[39m] [38;5;241m-[39m model[38;5;241m.[39mtimings_L[[38;5;241m0[39m][[38;5;241m0[39m][38;5;132;01m:[39;00m[38;5;124m.3[39m[38;5;132;01m}[39;00m[38;5;124m$[39m[38;5;124m"[39m)
  [1;32m      6[0m [38;5;66;03m# pu.plot_with_Ïƒ(model.t, model.system_energy().sum_baths(), ax=a, label=fr"$\delta={model.Î´[0]}$, $\tau_I={model.timings_L[0][1] - model.timings_L[0][0]:.3}$")[39;00m
  [0;32m----> 8[0m [38;5;28mprint[39m(model[38;5;241m.[39mtotal_energy()[38;5;241m.[39mconsistency(model[38;5;241m.[39mtotal_energy_from_power()), model[38;5;241m.[39msteady_index(), [43mmodel[49m[38;5;241;43m.[39;49m[43mpower[49m[43m([49m[43m)[49m[[38;5;241m-[39m[38;5;241m1[39m])

  File [0;32m~/src/two_qubit_model/hiro_models/otto_cycle.py:477[0m, in [0;36mOttoEngine.power[0;34m(self, *args, **kwargs)[0m
  [1;32m    474[0m steady_idx [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39msteady_index([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs)
  [1;32m    476[0m [38;5;28;01mif[39;00m steady_idx [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
  [0;32m--> 477[0m     [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m([38;5;124m"[39m[38;5;124mNo steady state available.[39m[38;5;124m"[39m)
  [1;32m    479[0m [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39mtotal_power()[38;5;241m.[39mslice([38;5;28mslice[39m(indices[steady_idx], [38;5;28;01mNone[39;00m, [38;5;241m1[39m))[38;5;241m.[39mmean

  [0;31mRuntimeError[0m: No steady state available.
#+end_example
[[file:./.ob-jupyter/67f43a5a1a06df0ba2927f3f3017926e9c01bce2.svg]]
:END:

#+begin_src jupyter-python
  ot.full_report(models[2])
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/9093522f05fe4e8ea2cc6c68f76a8c2af16b821a.svg]]
:RESULTS:
: \(P=-0.000678\pm 0.000024\)
: \(\eta=12.3\pm 0.8\)
[[file:./.ob-jupyter/cdf1a1ee3b683073de27624223cc38e501b62c40.svg]]
[[file:./.ob-jupyter/a5781362f995954863d0da9dba3590fb3bf0fc34.svg]]
:END:
